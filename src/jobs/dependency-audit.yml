description: >
  Job runs OWASP Dependency Check

executor: java

parameters:
  dependency_check_project_name:
    type: string
    description: "Name used by OWASP Dependency Check"

steps:
  - checkout
  - attach_workspace:
      at: .
  - run:
      name: Create file with current year and weak information - needed for cache
      command: echo "$(date +%U)-$(date +%Y)" > current_weak_information.txt
  #  - restore_cache:
  #      keys:
  ##        TODO Remove dev2 from key
  #        - dependency-check-data-dev2-{{ checksum "current_weak_information.txt" }}
  #        - dependency-check-data-dev2-
  - run:
      name: Download OWASP Dependency Check + Unzip
      command: |
        wget https://github.com/jeremylong/DependencyCheck/releases/download/v6.1.6/dependency-check-6.1.6-release.zip
        unzip dependency-check-6.1.6-release.zip
        ./dependency-check/bin/dependency-check.sh
  - run:
      name: Creates + Copy OWASP Cache Into Docker Volume
      command: |
        ls
        java --version
        wget
#  - save_cache:
#      paths:
#        - dependency-audit-data
#      key: dependency-check-data-dev2-{{ checksum "current_weak_information.txt" }}
#  - persist_to_workspace:
#      root: .
#      paths:
#        - odc-reports
